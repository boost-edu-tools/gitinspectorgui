# Auto-generated by scripts/switch-ci.sh. DO NOT EDIT.
# Base GitLab CI/CD configuration
# Contains common stages and variables

stages:
    - test
    - build
    - docs
    - release

variables:
    CARGO_HOME: $CI_PROJECT_DIR/.cargo
    CARGO_TARGET_DIR: $CI_PROJECT_DIR/target

.cache_template: &cache_template
    cache:
        key: ${CI_COMMIT_REF_SLUG}
        paths:
            - .cargo/
            - target/
            - node_modules/
            - python/.venv/

image: node:lts

pages:
    stage: docs
    # Functions that should be executed before the build script is run
    before_script:
        - npm ci
    script:
        - ./scripts/test-docs-build.sh
    artifacts:
        paths:
            - public
    rules:
        # This ensures that only pushes to the default branch will trigger
        # a pages deploy
        - if: $CI_COMMIT_REF_NAME == $CI_DEFAULT_BRANCH

