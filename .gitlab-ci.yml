# Auto-generated by scripts/switch-ci.sh. DO NOT EDIT.
# Base GitLab CI/CD configuration
# Contains common stages and variables

stages:
    - test
    - build
    - docs
    - release

variables:
    CARGO_HOME: $CI_PROJECT_DIR/.cargo
    CARGO_TARGET_DIR: $CI_PROJECT_DIR/target

.cache_template: &cache_template
    cache:
        key: ${CI_COMMIT_REF_SLUG}
        paths:
            - .cargo/
            - target/
            - node_modules/
            - python/.venv/

# The Docker image that will be used to build your app
image: node:lts

pages:
    stage: docs
    # Functions that should be executed before the build script is run
    before_script:
        - npm ci
    script:
        - ./scripts/test-docs-build.sh
    artifacts:
        paths:
            - public
    rules:
        # This rule ensures the job runs only when:
        # 1. It's a push to the default branch.
        # 2. Files in the documentation directory or key config files have changed.
        - if: $CI_COMMIT_REF_NAME == $CI_DEFAULT_BRANCH
          changes:
              - docs/**/*
              - mkdocs.yml
              - pyproject.toml
              - .ci/docs.yml

