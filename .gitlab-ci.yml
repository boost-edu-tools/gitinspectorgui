# Auto-generated by scripts/switch-ci.sh. DO NOT EDIT.
# Base GitLab CI/CD configuration
# Contains common stages and variables

stages:
    - test
    - build
    - docs
    - release

variables:
    CARGO_HOME: $CI_PROJECT_DIR/.cargo
    CARGO_TARGET_DIR: $CI_PROJECT_DIR/target

.cache_template: &cache_template
    cache:
        key: ${CI_COMMIT_REF_SLUG}
        paths:
            - .cargo/
            - target/
            - node_modules/
            - python/.venv/

# The Docker image that will be used to build your app
image: node:lts

# Placeholder job to satisfy GitLab CI requirements
# Individual pages disabled/removed - documentation served via group pages
documentation_info:
    stage: test
    script:
        - echo "Documentation served via group pages at https://edu-boost.gitlab.io/gitinspectorgui/"

# Trigger edu-boost.gitlab.io pipeline when documentation changes
trigger_docs_rebuild:
    stage: docs
    image: alpine:latest 
    before_script:
        - apk add --no-cache curl
    script:
        - echo "Documentation changes detected, triggering group pages rebuild..."
        - |
            if curl -f -X POST \
                -F token=$DOCS_TRIGGER_TOKEN \
                -F ref=main \
                "https://gitlab.com/api/v4/projects/edu-boost%2Fedu-boost.gitlab.io/trigger/pipeline"; then
                echo "Group pages rebuild triggered successfully"
            else
                echo "Failed to trigger rebuild, but continuing..."
            fi
    rules:
        - if: $CI_COMMIT_REF_NAME == $CI_DEFAULT_BRANCH
          changes:
            - "docs/**/*"
    allow_failure: true
